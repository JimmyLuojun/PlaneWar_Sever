{% extends "base.html" %}

{% block title %}Leaderboard - PlaneWar Server{% endblock %}

{% block content %}
    <h2>Top Scores</h2>

    {% if scores_data %}
    <table>
        <thead>
            <tr>
                <th>Rank</th>
                <th>Player</th>
                <th>Score</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody>
            {% for score, username in scores_data %}
            <tr>
                <td>{{ loop.index + rank_offset }}</td> {# Calculate rank based on loop and offset #}
                <td>{{ username }}</td>
                <td>{{ "{:,}".format(score.score_value) }}</td> {# Format score with commas #}
                <td>{{ score.timestamp.strftime('%Y-%m-%d %H:%M') }}</td> {# Format date #}
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {# --- Pagination Controls --- #}
    {% if pagination and pagination.pages > 1 %}
    <div class="pagination">
        {% if pagination.has_prev %}
            <a href="{{ url_for('views.leaderboard', page=pagination.prev_num) }}">&laquo; Previous</a>
        {% else %}
            <span>&laquo; Previous</span>
        {% endif %}

        <span> Page {{ pagination.page }} of {{ pagination.pages }} </span>

        {% if pagination.has_next %}
            <a href="{{ url_for('views.leaderboard', page=pagination.next_num) }}">Next &raquo;</a>
        {% else %}
            <span>Next &raquo;</span>
        {% endif %}
    </div>
     <p>Showing scores {{ rank_offset + 1 }} to {{ rank_offset + scores_data|length }} of {{ pagination.total }}.</p>
    {% endif %}

    {% else %}
        <p>No scores submitted yet!</p>
    {% endif %}

{% endblock %}